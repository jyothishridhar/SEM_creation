# Copyright (c) 2010-2024 openpyxl

import weakref


class Singleton(type):
    """
    Singleton metaclass
    Based on Python Cookbook 3rd Edition Recipe 9.13
    Only one instance of a class can exist. Does not work with __slots__
    """

    def __init__(self, *args, **kw):
<<<<<<< HEAD
        super().__init__(*args, **kw)
=======
        super(Singleton, self).__init__(*args, **kw)
>>>>>>> 7ef3263bf8ad3edda12247249d99ea6f271604bd
        self.__instance = None

    def __call__(self, *args, **kw):
        if self.__instance is None:
<<<<<<< HEAD
            self.__instance = super().__call__(*args, **kw)
=======
            self.__instance = super(Singleton, self).__call__(*args, **kw)
>>>>>>> 7ef3263bf8ad3edda12247249d99ea6f271604bd
        return self.__instance


class Cached(type):
    """
    Caching metaclass
    Child classes will only create new instances of themselves if
    one doesn't already exist. Does not work with __slots__
    """

    def __init__(self, *args, **kw):
<<<<<<< HEAD
        super().__init__(*args, **kw)
=======
        super(Singleton, self).__init__(*args, **kw)
>>>>>>> 7ef3263bf8ad3edda12247249d99ea6f271604bd
        self.__cache = weakref.WeakValueDictionary()

    def __call__(self, *args):
        if args in self.__cache:
            return self.__cache[args]

<<<<<<< HEAD
        obj = super().__call__(*args)
=======
        obj = super(Singleton, self).__call__(*args)
>>>>>>> 7ef3263bf8ad3edda12247249d99ea6f271604bd
        self.__cache[args] = obj
        return obj
